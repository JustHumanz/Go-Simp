apiVersion: apps/v1
kind: Deployment
metadata:
  name: go-simp-pilot
  labels:           
    app: go-simp
    tier: backend
spec:
  selector:
    matchLabels:    
      app: pilot
      tier: backend
  template:         
    metadata:
      labels:       
        app: pilot
        tier: backend
    spec:           
      containers:
        - name: go-simp-pilot
          image: justhumanz/go-simp
          #imagePullPolicy: IfNotPresent  
          volumeMounts:
          - name: config-volume
            mountPath: /app/Go-Simp
          workingDir: /app/Go-Simp/service/pilot/
          command: go build -o pilot && ./pilot            
      volumes:
        - name: config-volume
          configMap:
            name: Go-Simp_config_file             
      restartPolicy: OnFailure            